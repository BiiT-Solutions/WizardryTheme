<div class="biit-input" aria-haspopup="listbox"
     *ngIf="!icon"
     [class.compact]="isCompact"
     [class.disabled]="isDisabled"
     (keydown)="!isDisabled && handleKeyboardEvents($event)"
     (keydown.enter)="!dropdownOpen && !isDisabled && openDropdown()"
>
  <div class="input-container" #input>
    <input  id="input" [ngModel]="dropdownOpen ? filterText :
                      currentValue && isPrimitive ? currentValue :
                      currentValue && currentValue[label] ? currentValue[label] : ''"
           (ngModelChange)="filterText = $event; handleFilter()"
           (click)="!dropdownOpen && !isDisabled && openDropdown()"
           [placeholder]="dropdownOpen && currentValue && isPrimitive ? currentValue :
                          dropdownOpen && currentValue && currentValue[label] ? currentValue[label] : ''"
           tabindex="0"
           class="input-object"
           [class.grey-bg]="dropdownOpen"
           [class.default-cursor]="dropdownOpen"
           [disabled]="isDisabled"
           [readonly]="!dropdownOpen"/>
    <div class="input-show-icon-container"
         [class.passthrough]="!dropdownOpen"
         [class.rotate-90]="dropdownOpen"
         (click)="dropdownOpen && closeDropdown()">
      <biit-icon [name]="'right_arrow'"
                 class="input-show-icon"
                 [pathStyle]="{fill: isDisabled ? '#D9D9D9' : dropdownOpen ? '#F20D5E' : '#262626'}"
      ></biit-icon>
    </div>
    <div id="dropdown-label"
           class="input-placeholder"
           [class.disabled]="isDisabled"
           [class.compact]="dropdownOpen || currentValue">
      {{title}}
      <a *ngIf="isRequired"
         [style.color]="currentValue ? null : 'red'">*</a>
    </div>
    <div class="bottom-line"
         [class.disabled]="isDisabled"
    ></div>
    <span class="description">{{description}}</span>
  </div>
</div>
<button biit-icon
        *ngIf="icon"
        [icon]="icon"
        (click)="!dropdownOpen ? openDropdown() : closeDropdown()"
        [checked]="dropdownOpen"
        [disabled]="isDisabled"
></button>
<div style="position: relative; height: 0; width: 100%">
  <div #dropdown
       [class.disabled]="isDisabled"
       [style.overflow]="dropdownOpen ? undefined : 'hidden'"
       class="dropdown-list"
       role="listbox"
       aria-expanded="false"
       aria-labelledby="dropdown-label"
       [class.dropdown-open]="dropdownOpen"
       [class.compact]="isCompact"
       (keydown)="handleKeyboardEvents($event)"
  >
    <button *ngFor="let item of filteredData; index as i"
            (click)="onModelChange(item)"
            [class.selected]="currentValue === item"
            class="dropdown-item"
            role="option"
            aria-selected="false"
            [id]="i"
            [tabindex]="!dropdownOpen || isDisabled ? -1 : 0"
            [disabled]="!dropdownOpen || isDisabled"
    >
      <div>
        <a>{{isPrimitive ? item : item[label]}}</a>
        <span *ngIf="descriptionLabel && item[descriptionLabel]" class="description">{{item[descriptionLabel]}}</span>
      </div>
    </button>
    <button *ngIf="!filteredData.length"
            class="dropdown-item no-results"
            disabled
    >
      <a>No results found</a>
    </button>
  </div>
</div>
